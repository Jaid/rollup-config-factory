{"version":3,"file":"PkgPlugin.js","sourceRoot":"","sources":["../../../../src/plugin/PkgPlugin.ts"],"names":[],"mappings":"AAGA,OAAO,gBAAgB,MAAM,uCAAuC,CAAA;AAEpE,MAAM,OAAO,SAAS;IACpB,OAAO,CAAA;IACP,GAAG,CAAyB;IAC5B,YAAY,OAAY;QACtB,IAAI,CAAC,OAAO,GAAG,EAAE,CAAA;IACnB,CAAC;IACD,KAAK,CAAC,OAAsB,EAAE,KAAY;QACxC,KAAK,CAAC,eAAe,CAAC,GAAG,CAAC,SAAS,CAAC,IAAI,EAAE,GAAG,EAAE;YAC7C,MAAM,iBAAiB,GAAG;gBACxB,GAAG,EAAE,OAAO,CAAC,GAAG;gBAChB,WAAW,EAAE,KAAK;gBAClB,aAAa,EAAE;oBACb,cAAc;oBACd,kBAAkB;oBAClB,sBAAsB;oBACtB,sBAAsB;iBACvB;aACF,CAAA;YACD,OAAO,CAAC,eAAe,CAAC,gBAAgB,EAAE;gBACxC,iBAAiB;gBACjB,MAAM,EAAE;oBACN,IAAI,EAAE,UAAU;oBAChB,IAAI,EAAE,QAAQ;oBACd,KAAK,EAAE,YAAY;iBACpB;aACF,CAAC,CAAA;QACJ,CAAC,CAAC,CAAA;IACJ,CAAC;CACF","sourcesContent":["import type {ConfigBuilder, ConfigBuilderPlugin, Hooks} from '../ConfigBuilder.js'\nimport type {PackageJson} from 'type-fest'\n\nimport publishimoPlugin from 'src/plugin/rollupPlugin/publishimo.js'\n\nexport class PkgPlugin implements ConfigBuilderPlugin {\n  options\n  pkg: PackageJson | undefined\n  constructor(options?: {}) {\n    this.options = {}\n  }\n  apply(builder: ConfigBuilder, hooks: Hooks) {\n    hooks.buildProduction.tap(PkgPlugin.name, () => {\n      const publishimoOptions = {\n        pkg: builder.pkg,\n        fetchGithub: false,\n        includeFields: [\n          `dependencies`,\n          `peerDependencies`,\n          `peerDependenciesMeta`,\n          `optionalDependencies`,\n        ],\n      }\n      builder.addRollupPlugin(publishimoPlugin, {\n        publishimoOptions,\n        extend: {\n          main: `index.js`,\n          type: `module`,\n          types: `types.d.ts`,\n        },\n      })\n    })\n  }\n}\n"]}